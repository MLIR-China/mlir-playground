name: Deploy Preview

on:
  workflow_run:
    workflows: [Build Clang WASM image]
    types: [completed]

concurrency:
  group: deploy-dev-${{ github.ref }}
  cancel-in-progress: true

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    uses: ./.github/workflows/deploy-site.yml
    with:
      deploy_message: "Deploy branch ${{ github.ref }}"
    secrets: inherit
